---
title: "Reverse Engineering Project"
author: "Student names here"
date: "Date here"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction 

In this notebook, we are reverse engineering the story, [As police struggle to solve homicides, Baltimore residents see an ‘open season for killing’](https://www.washingtonpost.com/investigations/as-police-struggle-to-solve-homicides-baltimore-residents-see-an-open-season-for-killing/2018/12/26/7ee561e4-fb24-11e8-8c9a-860ce2a8148f_story.html)

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(lubridate)
```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data. 

```{r}
homicide_data <- read_csv('data/homicide-data.csv')

homicide_data <- homicide_data %>% 
  mutate(
    reported_date=as_date(ymd(reported_date))
  )

glimpse(homicide_data)

baltimore_homicide_data <- homicide_data %>% 
  filter (
    city == 'Baltimore'
  )

```

## Sentences to Engineer
In this notebook, we are reverse engineering five sentences from the story.

### Sentence 1

* **Sentence text**: City police made an arrest in 41 percent of homicides in 2014; last year, the rate was just 27 percent, a 14 percentage point drop.
* **Analysis summary**: After we successfully filtered and grouped the data in the years 2014 and 2017, we added all the murders up (112+86+13=211 for 2014, 236+93+11=340 for 2017), then divided the "Closed with Arrest" murders by the total murders for each year (86/211 and 93/340, respectively). This gave us a 40.75% arrest rate for 2014, and 27.35% for 2017. This correlates to a 14 percentage point drop, as they found in the original article. 

```{r}
baltimore_homicide_data %>% 
  filter (
    reported_date >= "2014-01-01" & 
    reported_date < "2015-01-01") %>% 
  group_by(disposition) %>% 
  summarize(
    count_murders=n()
  ) %>% 
  arrange(desc(count_murders))


baltimore_homicide_data %>% 
  filter (
    reported_date >= "2017-01-01" &
    reported_date < "2018-01-01"
  ) %>% 
  group_by(disposition) %>% 
  summarize(
    count_murders=n()
  ) %>% 
  arrange(desc(count_murders))

```

### Sentence 2

* **Sentence text**: As violence in the city has risen since 2015, the likelihood of a killer being arrested has dropped precipitously.
* **Analysis summary**: We do see the Post's results replicated by our code. The number of arrests categorized as "Open" or "Closed without arrest" jumps sharply in 2015 and stays high through the end of 2017.

```{r}
baltimore_homicides_by_year <- baltimore_homicide_data %>% 
  mutate(
    year = case_when(
      reported_date < '2008-01-01' ~ '2007',
      reported_date >= '2008-01-01' & reported_date < '2009-01-01' ~ '2008',
      reported_date >= '2009-01-01' & reported_date < '2010-01-01' ~ '2009',
      reported_date >= '2010-01-01' & reported_date < '2011-01-01' ~ '2010',
      reported_date >= '2011-01-01' & reported_date < '2012-01-01' ~ '2011',
      reported_date >= '2012-01-01' & reported_date < '2013-01-01' ~ '2012',
      reported_date >= '2013-01-01' & reported_date < '2014-01-01' ~ '2013',
      reported_date >= '2014-01-01' & reported_date < '2015-01-01' ~ '2014',
      reported_date >= '2015-01-01' & reported_date < '2016-01-01' ~ '2015',
      reported_date >= '2016-01-01' & reported_date < '2017-01-01' ~ '2016',
      reported_date >= '2017-01-01' ~ '2017'
    )
  )

baltimore_yearly_arrest_rate <- baltimore_homicides_by_year %>% 
  group_by(year,disposition) %>% 
  summarize(
    count_homicides=n()
  )

show(baltimore_yearly_arrest_rate)
```

### Sentence 3

* **Sentence text**: Of the 1,002 homicides between 2015 and the beginning of this year, just 252 — one out of every four — resulted in an arrest.
* **Analysis summary**: We were able to replicate the Post's findings for this. Of all the homicides reported after 2018, our filter and group by queries showed that there were 252 closed by arrest out of a total of 1002. It's not exactly 1 in 4, but it's close.

```{r}
baltimore_homicide_data %>% 
  filter(
    reported_date > '2015-01-01'
  ) %>% 
  group_by(disposition) %>% 
  summarize(
    count_homicides=n()
  ) %>% 
    arrange(count_homicides)
```

### Sentence 4

* **Sentence text**: For most of the decade before 2015, Baltimore’s annual homicide arrest rate hovered at about 40 percent. Since 2015, the arrest rate hasn’t topped 30 percent in any year
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

```{r}
baltimore_yearly_arrests_transposed <- as.data.frame(t(baltimore_yearly_arrest_rate))

```

### Sentence 5

* **Sentence text**: Baltimore is also one of 30 cities that have seen an increase in homicides in recent years, with the greatest raw number increase in killings of any city other than Chicago, which has four times the population.
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here

# Display results of code below this codeblock

```

-30-